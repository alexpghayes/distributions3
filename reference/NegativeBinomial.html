<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a negative binomial distribution — NegativeBinomial • distributions3</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a negative binomial distribution — NegativeBinomial"><meta name="description" content="A generalization of the geometric distribution. It is the number
of failures in a sequence of i.i.d. Bernoulli trials before
a specified target number (\(r\)) of successes occurs."><meta property="og:description" content="A generalization of the geometric distribution. It is the number
of failures in a sequence of i.i.d. Bernoulli trials before
a specified target number (\(r\)) of successes occurs."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@alexpghayes"><meta name="twitter:site" content="@alexpghayes"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">distributions3</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-sign-tests.html">One sample sign tests</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-t-test.html">One sample T-tests</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-z-test.html">One sample Z-tests</a></li>
    <li><a class="dropdown-item" href="../articles/paired-tests.html">Paired tests</a></li>
    <li><a class="dropdown-item" href="../articles/poisson.html">The Poisson distribution: From basic probability theory to regression models</a></li>
    <li><a class="dropdown-item" href="../articles/two-sample-z-test.html">Two sample Z-tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alexpghayes/distributions3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a negative binomial distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions3/blob/main/R/NegativeBinomial.R" class="external-link"><code>R/NegativeBinomial.R</code></a></small>
      <div class="d-none name"><code>NegativeBinomial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A generalization of the geometric distribution. It is the number
of failures in a sequence of i.i.d. Bernoulli trials before
a specified target number (\(r\)) of successes occurs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NegativeBinomial</span><span class="op">(</span><span class="va">size</span>, p <span class="op">=</span> <span class="fl">0.5</span>, mu <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>The target number of successes (greater than \(0\))
until the experiment is stopped. Denoted \(r\) below.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>The success probability for a given trial. <code>p</code> can be any
value in <code>[0, 1]</code>, and defaults to <code>0.5</code>.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>Alternative parameterization via the non-negative mean
of the distribution (instead of the probability <code>p</code>), defaults to <code>size</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>NegativeBinomial</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We recommend reading this documentation on
<a href="https://alexpghayes.github.io/distributions3/">https://alexpghayes.github.io/distributions3/</a>, where the math
will render with additional detail and much greater clarity.</p>
<p>In the following, let \(X\) be a negative binomial random variable with
success probability <code>p</code> = \(p\).</p>
<p><strong>Support</strong>: \(\{0, 1, 2, 3, ...\}\)</p>
<p><strong>Mean</strong>: \(\frac{(1 - p) r}{p} = \mu\)</p>
<p><strong>Variance</strong>: \(\frac{(1 - p) r}{p^2}\)</p>
<p><strong>Probability mass function (p.m.f.)</strong>:</p>
<p>$$
     f(k) = {k + r - 1 \choose k} \cdot p^r (1-p)^k
  $$</p>
<p><strong>Cumulative distribution function (c.d.f.)</strong>:</p>
<p>Omitted for now.</p>
<p><strong>Moment generating function (m.g.f.)</strong>:</p>
<p>$$
     \left(\frac{p}{1 - (1 -p) e^t}\right)^r, t &lt; -\log (1-p)
  $$</p>
<p><strong>Alternative parameterization</strong>: Sometimes, especially when used in
regression models, the negative binomial distribution is parameterized
by its mean \(\mu\) (as listed above) plus the size parameter \(r\).
This implies a success probability of \(p = r/(r + \mu)\). This can
also be seen as a generalization of the Poisson distribution where the
assumption of equidispersion (i.e., variance equal to mean) is relaxed.
The negative binomial distribution is overdispersed (i.e., variance greater than mean)
and its variance can also be written as \(\mu + 1/r \mu^2\). The Poisson
distribution is then obtained as \(r\) goes to infinity. Note that in this
view it is natural to also allow for non-integer \(r\) parameters.
The factorials in the equations above are then expressed in terms of the
gamma function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other discrete distributions:
<code><a href="Bernoulli.html">Bernoulli</a>()</code>,
<code><a href="Binomial.html">Binomial</a>()</code>,
<code><a href="Categorical.html">Categorical</a>()</code>,
<code><a href="Geometric.html">Geometric</a>()</code>,
<code><a href="HurdleNegativeBinomial.html">HurdleNegativeBinomial</a>()</code>,
<code><a href="HurdlePoisson.html">HurdlePoisson</a>()</code>,
<code><a href="HyperGeometric.html">HyperGeometric</a>()</code>,
<code><a href="Multinomial.html">Multinomial</a>()</code>,
<code><a href="Poisson.html">Poisson</a>()</code>,
<code><a href="PoissonBinomial.html">PoissonBinomial</a>()</code>,
<code><a href="ZINegativeBinomial.html">ZINegativeBinomial</a>()</code>,
<code><a href="ZIPoisson.html">ZIPoisson</a>()</code>,
<code><a href="ZTNegativeBinomial.html">ZTNegativeBinomial</a>()</code>,
<code><a href="ZTPoisson.html">ZTPoisson</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">NegativeBinomial</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NegativeBinomial(size = 5, p = 0.1)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="random.html">random</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 95 37 48 93 18 16 32 43 27 17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="pdf.html">pdf</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01629887</span>
<span class="r-in"><span><span class="fu"><a href="pdf.html">log_pdf</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -4.11666</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="cdf.html">cdf</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6548517</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 53</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## alternative parameterization of X</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">NegativeBinomial</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">45</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NegativeBinomial(mu = 45, size = 5)"</span>
<span class="r-in"><span><span class="fu"><a href="cdf.html">cdf</a></span><span class="op">(</span><span class="va">Y</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6548517</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Y</span>, <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 53</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Hayes, Ralph Moller-Trane, Daniel Jordan, Paul Northrop, Moritz N. Lang, Achim Zeileis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

