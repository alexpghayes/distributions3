<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>One sample Z-tests • distributions3</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="One sample Z-tests">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">distributions3</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-sign-tests.html">One sample sign tests</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-t-test.html">One sample T-tests</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a></li>
    <li><a class="dropdown-item" href="../articles/one-sample-z-test.html">One sample Z-tests</a></li>
    <li><a class="dropdown-item" href="../articles/paired-tests.html">Paired tests</a></li>
    <li><a class="dropdown-item" href="../articles/poisson.html">The Poisson distribution: From basic probability theory to regression models</a></li>
    <li><a class="dropdown-item" href="../articles/two-sample-z-test.html">Two sample Z-tests</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alexpghayes/distributions3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>One sample Z-tests</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions3/blob/main/vignettes/one-sample-z-test.Rmd" class="external-link"><code>vignettes/one-sample-z-test.Rmd</code></a></small>
      <div class="d-none name"><code>one-sample-z-test.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we work through an example Z-test, and point out a
number of points where you might get stuck along the way.</p>
<div class="section level2">
<h2 id="problem-setup">Problem setup<a class="anchor" aria-label="anchor" href="#problem-setup"></a>
</h2>
<p>Let’s suppose that a student is interesting in estimating how many
memes their professors know and love. So they go to class, and every
time a professor uses a new meme, they write it down. After a year of
classes, the student has recorded the following meme counts, where each
count corresponds to a single class they took:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">
  3, 7, 11, 0, 7, 0, 4, 5, 6, 2
</annotation></semantics></math></p>
<p>The student talks to some other students who’ve done similar studies
and determines that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma = 2</annotation></semantics></math>
is a reasonable value for the standard deviation of this
distribution.</p>
</div>
<div class="section level2">
<h2 id="assumption-checking">Assumption checking<a class="anchor" aria-label="anchor" href="#assumption-checking"></a>
</h2>
<p>Before we can do a Z-test, we need to make check if we can reasonably
treat the mean of this sample as normally distributed. This happens is
the case of either of following hold:</p>
<ol style="list-style-type: decimal">
<li>The data comes from a normal distribution.</li>
<li>We have lots of data. How much? Many textbooks use 30 data points as
a rule of thumb.</li>
</ol>
<p>Since we have a small sample, we should check if the data comes from
a normal distribution using a normal quantile-quantile plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in the data</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make the qqplot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqline</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="one-sample-z-test_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Since the data lies close the line
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y = x</annotation></semantics></math>,
and has no notable systematic deviations from line, it’s safe to treat
the sample as coming from a normal distribution. We can proceed with our
hypothesis test.</p>
</div>
<div class="section level2">
<h2 id="null-hypothesis-and-test-statistic">Null hypothesis and test statistic<a class="anchor" aria-label="anchor" href="#null-hypothesis-and-test-statistic"></a>
</h2>
<p>Let’s test the null hypothesis that, on average, professors know 3
memes. That is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>=</mo><mn>3</mn><mspace width="2.0em"></mspace><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><mi>μ</mi><mo>≠</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">
  H_0: \mu = 3 \qquad H_A: \mu \neq 3
</annotation></semantics></math></p>
<p>First we need to calculate our Z-statistic. Let’s do this with R.
Remember that the Z-statistic is defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mfrac><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>∼</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  Z = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}} \sim \mathrm{Normal}(0, 1)
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="calculating-p-values">Calculating p-values<a class="anchor" aria-label="anchor" href="#calculating-p-values"></a>
</h2>
<p>In R this looks like:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the z-statistic</span></span>
<span><span class="va">z_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z_stat</span></span>
<span><span class="co">#&gt; [1] 2.371708</span></span></code></pre></div>
<p>To calculate a two-sided p-value, we need to find</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Z</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>≥</mo><mrow><mo stretchy="true" form="prefix">|</mo><mn>2.37</mn><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≥</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≤</mo><mo>−</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≤</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≤</mo><mo>−</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
  P(|Z| \ge |2.37|)
  &amp;= P(Z \ge 2.37) + P(Z \le -2.37) \\
  &amp;= 1 - P(Z \le 2.37) + P(Z \le -2.37) \\
  &amp;= 1 - \Phi(2.37) + \Phi(-2.37)
\end{align}
</annotation></semantics></math></p>
<p>To do this we need to c.d.f. of a standard normal</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexpghayes/distributions3" class="external-link">distributions3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normal.html">Normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># make a standard normal r.v.</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2.37</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="op">-</span><span class="fl">2.37</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01778809</span></span></code></pre></div>
<p>Note that we saved <code>z_stat</code> above so we could have also
done</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01770607</span></span></code></pre></div>
<p>which is slightly more accurate since there is no rounding error.</p>
<p>So our p-value is about 0.0177. You should verify this with a
Z-table. Note that you should get the <em>same</em> value from
<code>cdf(Z, 2.37)</code> and looking up <code>2.37</code> on a
Z-table.</p>
<p>You may also have seen a different formula for the p-value of a
two-sided Z-test, which makes use of the fact that the normal
distribution is symmetric:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Z</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>≥</mo><mrow><mo stretchy="true" form="prefix">|</mo><mn>2.37</mn><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>≤</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">|</mo><mn>2.37</mn><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
  P(|Z| \ge |2.37|)
  &amp;= 2 \cdot P(Z \le -|2.37|) \\
  &amp;= 2 \cdot \Phi(-2.37)
\end{align}
</annotation></semantics></math></p>
<p>Using this formula we get the same result:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="op">-</span><span class="fl">2.37</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01778809</span></span></code></pre></div>
<p>Finally, sometimes we are interest in one sided Z-tests. For the
test</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>≤</mo><mn>3</mn><mspace width="2.0em"></mspace><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><mi>μ</mi><mo>&gt;</mo><mn>3</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
  H_0: \mu \le 3 \qquad H_A: \mu &gt; 3
\end{align}
</annotation></semantics></math></p>
<p>the p-value is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&gt;</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  P(Z &gt; 2.37)
</annotation></semantics></math></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2.37</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.008894043</span></span></code></pre></div>
<p>For the test</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>≥</mo><mn>3</mn><mspace width="2.0em"></mspace><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><mi>μ</mi><mo>&lt;</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">
  H_0: \mu \ge 3 \qquad H_A: \mu &lt; 3
</annotation></semantics></math></p>
<p>the p-value is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mn>2.37</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  P(Z &lt; 2.37)
</annotation></semantics></math></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2.37</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.991106</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rejection-regions">Rejection regions<a class="anchor" aria-label="anchor" href="#rejection-regions"></a>
</h2>
<p><strong>Preface</strong>: I am strongly opposed to make a dichotomous
“reject/fail to reject” decision for hypothesis tests. If you do a
hypothesis test, you should report the p-value, period. Picking an
arbitrary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level rejection threshold and treating it as a gold standard is
ridiculous, as evidenced by 60 years of statistical literature laden
with warnings about hypothesis testing. That said, sometimes it can be
useful to think about when you reject a hypothesis test.</p>
<p>We can think about three different rejection regions for a
Z-test:</p>
<ol style="list-style-type: decimal">
<li>The rejection region in terms of the p-value</li>
<li>The rejection region in terms of the test statistic</li>
<li>The rejection region in terms of the sample mean</li>
</ol>
<p>For a given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level threshold, all of these rejection regions are equivalent. We’ll
start by thinking about the rejection of a two-sided test. That is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mn>0</mn></msub><mspace width="2.0em"></mspace><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><mi>μ</mi><mo>≠</mo><msub><mi>μ</mi><mn>0</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
H_0 : \mu = \mu_0 \qquad H_A : \mu \neq \mu_0
\end{align}
</annotation></semantics></math></p>
<p>We then calculate a test statistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><annotation encoding="application/x-tex">Z_\text{obs}</annotation></semantics></math>,
and a p-value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Z</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&gt;</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(|Z| &gt; |Z_\text{obs}|)</annotation></semantics></math>
and reject when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Z</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&gt;</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">P(|Z| &gt; |Z_\text{obs}|) &lt; \alpha</annotation></semantics></math>.
This defines our first rejection region. Using our observation from
before, this is exactly equivalent to rejecting when</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Z</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&gt;</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><mn>2</mn><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi><mi>/</mi><mn>2</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
P(|Z| &gt; |Z_\text{obs}|) &lt; \alpha 
&amp; \Longleftrightarrow 2 \cdot P(Z &lt; -|Z_\text{obs}|) &lt; \alpha \\
&amp; \Longleftrightarrow P(Z &lt; -|Z_\text{obs}|) &lt; \alpha / 2
\end{align}
</annotation></semantics></math></p>
<p>and this last statement is exactly the same as when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo>&lt;</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Z_\text{obs} &lt; z_{\alpha / 2}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo>&lt;</mo><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub></mrow><annotation encoding="application/x-tex">z_{1 - \alpha / 2} &lt; Z_\text{obs}</annotation></semantics></math>.
This is our second region region, in terms of the test statistic.
Finally, recall that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mtext mathvariant="normal">obs</mtext></msub><mo>=</mo><mfrac><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">
  Z_\text{obs} = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}}
</annotation></semantics></math></p>
<p>So we take the conditions and rearrange to in terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>x</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar x</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&gt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\frac{\bar x - \mu_0}{\sigma / \sqrt{n}} &gt; z_{1 - \alpha / 2}
&amp; \Longleftrightarrow \bar x &gt; \mu_0 + z_{1 - \alpha / 2} \frac{\sigma}{\sqrt n}
\end{align}
</annotation></semantics></math></p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>&lt;</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&lt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\frac{\bar x - \mu_0}{\sigma / \sqrt{n}} &lt; z_{\alpha / 2}
&amp; \Longleftrightarrow \bar x &lt; \mu_0 + z_{\alpha / 2} \frac{\sigma}{\sqrt n}
\end{align}
</annotation></semantics></math></p>
<p>You can also think about this in terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math>.
We will reject the test when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math>
is not in</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo>,</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\left( \bar x + z_{\alpha / 2} \frac{\sigma}{\sqrt n},
  \bar x + z_{1 - \alpha / 2} \frac{\sigma}{\sqrt n} \right)
\end{align}
</annotation></semantics></math></p>
<p>which you may recognize as the confidence interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>!
So the confidence interval contains all the values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math>
that we cannot reject at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level. You can perform a similar calculation for a one sided test,
resulting in a one-sided confidence bound, where one end of the interval
is either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="power-and-sample-size-calculations">Power and sample size calculations<a class="anchor" aria-label="anchor" href="#power-and-sample-size-calculations"></a>
</h2>
<div class="section level3">
<h3 id="formulas-for-power">Formulas for power<a class="anchor" aria-label="anchor" href="#formulas-for-power"></a>
</h3>
<p>We want to make sure that we actually reject our null hypothesis in
the case that it is false. That is, we would like to make sure that our
test has high power. Mathematically, this means that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is false</mtext></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\text{reject } H_0 | H_0 \text{ is false})</annotation></semantics></math>.
The problem here is that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
can be wrong in many different ways: it could be that the true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>,
it could be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7</mn><annotation encoding="application/x-tex">7</annotation></semantics></math>,
it could be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4.26</mn><annotation encoding="application/x-tex">4.26</annotation></semantics></math>.
So to calculate power as formulated above is not really possible.
However, we can calculate power for specific versions of
“<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
is false”.</p>
<p>Let’s consider the case that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
is false, and in particular the true value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>A</mi></msub><annotation encoding="application/x-tex">\mu_A</annotation></semantics></math>.
In this case, the power of our test is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\text{reject } H_0 | \mu = \mu_A)</annotation></semantics></math>.
<a href="#rejection-regions">Recall</a> that we reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&gt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\bar{x} &gt; \mu_0 + z_{1 - \alpha / 2} \frac{\sigma}{\sqrt n}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&lt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\bar{x} &lt; \mu_0 + z_{\alpha / 2} \frac{\sigma}{\sqrt n}</annotation></semantics></math>,
so the power of our test when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">\mu = \mu_A</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>H</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">|</mo><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&gt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&lt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(\text{reject } H_0 \left | \mu = \mu_A \right .) =
  P\left( \left . \bar x &gt; \mu_0 + z_{1 - \alpha / 2}
    \frac{\sigma}{\sqrt n} \right | \mu =
  \mu_A \right) + P\left( \left . \bar x &lt; \mu_0 + z_{\alpha / 2}
    \frac{\sigma}{\sqrt n} \right | \mu = \mu_A \right).
</annotation></semantics></math></p>
<p>Remember that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>X</mi><mo accent="true">‾</mo></mover><mo>∼</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mfrac><msup><mi>σ</mi><mn>2</mn></msup><mi>n</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bar X \sim \mathrm{Normal} \left(\mu, \frac{\sigma^2}{n} \right)</annotation></semantics></math>.
This means that, given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">\mu = \mu_A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>∼</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mfrac><msup><mi>σ</mi><mn>2</mn></msup><mi>n</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bar{x} \sim \mathrm{Normal} \left(\mu, \frac{\sigma^2}{n} \right)</annotation></semantics></math>,
which let’s us calculate the probabilities we need to find the
power:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&gt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>&gt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&gt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
  P\left( \left . \bar{x} &gt; \mu_0 + z_{1 - \alpha / 2} \frac{\sigma}{\sqrt n} \right | \mu = \mu_A \right)
  &amp;= P\left( \frac{\bar{x} - \mu_A}{\sigma/\sqrt{n}} &gt; \frac{\mu_0 + z_{1-\alpha/2}\frac{\sigma}{\sqrt{n}} - \mu_A}{\sigma/\sqrt{n}} \right) \\
  &amp;= P\left( Z &gt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right),
\end{align}
</annotation></semantics></math></p>
<p>and similarly</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo>&lt;</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P\left( \left . \bar{x} &lt; \mu_0 + z_{\alpha / 2} \frac{\sigma}{\sqrt n} \right | \mu = \mu_A\right) = P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right).
</annotation></semantics></math></p>
<p>So, the power of our test, <em>if the true population mean is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>A</mi></msub><annotation encoding="application/x-tex">\mu_A</annotation></semantics></math></em>,
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Power</mtext></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&gt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
  \text{Power} &amp;= P\left( Z &gt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) + P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right) \\
  &amp;= \left[1 - P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right)\right] + P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right)
\end{align}
</annotation></semantics></math></p>
<p>Let’s calculate this if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>A</mi></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\mu_A = 5</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_lower</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="va">power_upper</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="va">power_lower</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="va">power_upper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8853791</span></span></code></pre></div>
<p>This means that the probability that we reject the null hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">H_0: \mu = 3</annotation></semantics></math>)
if the true mean is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn><annotation encoding="application/x-tex">5</annotation></semantics></math>
is about 0.89.</p>
</div>
<div class="section level3">
<h3 id="formulas-for-sample-size-calculations">Formulas for sample size calculations<a class="anchor" aria-label="anchor" href="#formulas-for-sample-size-calculations"></a>
</h3>
<p>Often times researchers like to go in the other direction: aim for a
specific level of power, and calculate how many observations are needed
to reach that level. To achieve a power of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>
for a one sample Z-test with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0 : \mu = \mu_0</annotation></semantics></math>,
you need</p>
<p><span class="math display">$$
  n \approx \left(
    {
      \sigma \cdot (z_{\alpha / 2} + z_\beta) \over
      \mu_0 - \mu_A
    }
  \right)^2
$$</span></p>
<p>samples. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is not an integer, round up. Often, the denominator is thought of as the
detectable difference. So, the question becomes how many samples are
required to have sufficient power to detect a difference of some
particular size.</p>
<p>This equation is simply a rewrite of the equation presented above for
power. Recall, the power for a two sided test is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Power</mtext><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&gt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Power} = P\left( Z &gt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) + P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right).
</annotation></semantics></math></p>
<p>Usually, only one of these terms is contributing while the other is
very close to zero. Let’s say the first term is the one clearly
different from zero. To determine the sample size, we want to determine
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&gt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">P\left( Z &gt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) = 1-\beta</annotation></semantics></math>.
Or, similarly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>&lt;</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) = \beta</annotation></semantics></math>.
I.e. we need
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo>=</mo><msub><mi>z</mi><mi>β</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} = z_{\beta}</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>z</mi><mi>β</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac><mo>+</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><msub><mi>z</mi><mi>β</mi></msub><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow><mrow><mi>σ</mi><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>β</mi></msub><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msqrt><mi>n</mi></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><mfrac><mrow><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>β</mi></msub><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow></mfrac><mo>=</mo><msqrt><mi>n</mi></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>⇔</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>β</mi></msub><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><mi>n</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
 z_{\beta} = \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} &amp; \Longleftrightarrow z_{\beta} - z_{1-\alpha/2} = \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} \\
  &amp; \Longleftrightarrow \sigma (z_{\beta} - z_{1-\alpha/2}) = (\mu_0-\mu_A)\sqrt{n} \\
 &amp; \Longleftrightarrow \frac{\sigma (z_{\beta} - z_{1-\alpha/2})}{\mu_0-\mu_A} = \sqrt{n} \\
 &amp; \Longleftrightarrow \left(\frac{\sigma (z_{\beta} - z_{1-\alpha/2})}{\mu_0-\mu_A}\right)^2 = n
\end{align}
</annotation></semantics></math></p>
<p>Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo>=</mo><mo>−</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">z_{1-\alpha/2} = -z_{\alpha/2}</annotation></semantics></math>,
we have the equation above:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>β</mi></msub><mo>+</mo><msub><mi>z</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>μ</mi><mi>A</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><mi>n</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \left(\frac{\sigma (z_{\beta} + z_{\alpha/2})}{\mu_0-\mu_A}\right)^2 = n.
</annotation></semantics></math></p>
<p>As an example, say the student prior to the experiment had determined
that they wanted to test if the number of memes their professors know
and love is 2. They want to make sure their sample size is large enough
so that they are likely to reject the null hypothesis if the true number
is 3. They determine that they want a probability of 0.9 of rejecting
the null if the true number is 3. So, a sample size calculation looks
like this:</p>
<p><span class="math display">$$
  n \approx \left(
    {
      2 \cdot (1.96 + 1.28) \over
      2-3
    }
  \right)^2 = 41.99
$$</span></p>
<p>So to make sure that they reject the null hypothesis with a
probability of 0.9 if the true value is 3, they would have to ask 53
professors.</p>
<p>Below is this same calculation done in <code>R</code>. Remember,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mo>−</mo><mtext mathvariant="normal">Power</mtext></mrow><annotation encoding="application/x-tex">\beta = 1-\text{Power}</annotation></semantics></math>.
Note the small discrepancy. This is due to rounding error.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">0.05</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 42.02969</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Hayes, Ralph Moller-Trane, Daniel Jordan, Paul Northrop, Moritz N. Lang, Achim Zeileis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
