<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="distributions3">
<title>Z confidence interval for a mean • distributions3</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Z confidence interval for a mean">
<meta property="og:description" content="distributions3">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">distributions3</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a>
    <a class="dropdown-item" href="../articles/one-sample-sign-tests.html">One sample sign tests</a>
    <a class="dropdown-item" href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a>
    <a class="dropdown-item" href="../articles/one-sample-t-test.html">One sample T-tests</a>
    <a class="dropdown-item" href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a>
    <a class="dropdown-item" href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a>
    <a class="dropdown-item" href="../articles/one-sample-z-test.html">One sample Z-tests</a>
    <a class="dropdown-item" href="../articles/paired-tests.html">Paired tests</a>
    <a class="dropdown-item" href="../articles/poisson.html">The Poisson distribution: From basic probability theory to regression models</a>
    <a class="dropdown-item" href="../articles/two-sample-z-test.html">Two sample Z-tests</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexpghayes/distributions3/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="one-sample-z-confidence-interval_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Z confidence interval for a mean</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions3/blob/HEAD/vignettes/one-sample-z-confidence-interval.Rmd" class="external-link"><code>vignettes/one-sample-z-confidence-interval.Rmd</code></a></small>
      <div class="d-none name"><code>one-sample-z-confidence-interval.Rmd</code></div>
    </div>

    
    
<p>The normal distribution also comes up frequently when calculating confidence intervals for sample means. Let’s calculate a 88 percent confidence interval for the same data from <code><a href="../articles/one-sample-z-test.html">vignette("one-sample-z-test")</a></code>, which was:</p>
<p><span class="math display">\[
  3, 7, 11, 0, 7, 0, 4, 5, 6, 2
\]</span></p>
<p>Again we will assume that <span class="math inline">\(\sigma = 2\)</span>. If you would like to see how to calculate a confidence interval for the mean of a single sample when you don’t know the population standard deviation <span class="math inline">\(\sigma\)</span>, see <code><a href="../articles/one-sample-t-confidence-interval.html">vignette("one-sample-t-confidence-interval")</a></code>.</p>
<p>Recall that a confidence interval for the mean based off the normal distribution is valid when:</p>
<ol style="list-style-type: decimal">
<li>The data comes from a normal distribution.</li>
<li>We have lots of data. How much? Many textbooks use 30 data points as a rule of thumb.</li>
</ol>
<p>In the Z-test example we verified that the sample seems to come from a normal distribution using a quantile-quantile plot (QQ-plot).</p>
<p>The formula for a confidence interval with confidence coefficient <span class="math inline">\(1 - \alpha\)</span> (in our case this is 0.88) is then:</p>
<p><span class="math display">\[
  \left( \bar x + z_{\alpha / 2} \cdot \frac{\sigma}{\sqrt{n}},
  \bar x + z_{1 - \alpha / 2} \cdot \frac{\sigma}{\sqrt{n}} \right)
\]</span></p>
<p>Where <span class="math inline">\(z_\alpha\)</span> stands for the alpha-ith quantile of a standard normal distribution. To get a quantile we need to take the inverse of the c.d.f. so you may also see <span class="math inline">\(z_\alpha\)</span> written as <span class="math inline">\(\Phi^{-1}(\alpha)\)</span>, where <span class="math inline">\(\Phi\)</span> is the c.d.f. of the standard normal. Since the standard normal distribution is symmetric around zero, this is exactly equivalent to</p>
<p><span class="math display">\[
  \left( \bar x - z_{1 - \alpha / 2} \cdot \frac{\sigma}{\sqrt{n}},
  \bar x + z_{1 - \alpha / 2} \cdot \frac{\sigma}{\sqrt{n}} \right)
\]</span></p>
<p>which may look slightly more familiar. Having trouble seeing what the difference is? Look at the subscript for <span class="math inline">\(z\)</span>. Let’s go ahead and calculate this out in R. Since our confidence coefficient is 0.88 (corresponding to an 88 percent confidence interval) we have:</p>
<p><span class="math display">\[
  0.88 = 1 - \alpha
\]</span></p>
<p>so that <span class="math inline">\(\alpha = 0.12\)</span>. Now we can get started.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexpghayes/distributions3" class="external-link">distributions3</a></span><span class="op">)</span>

<span class="co"># read in the data</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="co"># make a standard normal r.v.</span>
<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normal.html">Normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>

<span class="co"># first approach</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 3.516675</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 5.483325</span></code></pre></div>
<p>So our confidence interval using the first set of equations is (3.52, 5.48). Now we use the second set of equations:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># second approach</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 3.516675</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 5.483325</span></code></pre></div>
<p>We get the same thing! Just like we expected.</p>
<p>There’s one last thing we need to address. You may not have seen either of the formulas for a Z-confidence interval that I wrote. You may have seen the formulas:</p>
<p><span class="math display">\[
  \left( \bar x - z_{\alpha / 2} \cdot \frac{\sigma}{\sqrt{n}},
  \bar x + z_{\alpha / 2} \cdot \frac{\sigma}{\sqrt{n}} \right)
\]</span></p>
<p>If this is you, you have my condolences, and your instructor probably hates you. Ask that they use lower quantile notation rather than upper quantile notation.</p>
<p>This looks almost like the second approach, except using <span class="math inline">\(z_{\alpha / 2}\)</span> instead of <span class="math inline">\(z_{1 - \alpha / 2}\)</span>. What this comes down to is whether or not <span class="math inline">\(z_{\alpha / 2}\)</span> represents a <em>lower quantile</em> or an <em>upper quantile</em>. For a lower quantile, you look at the p.d.f. and start integrating from negative infinity, stop when the integral equals <span class="math inline">\(\alpha\)</span>, and that take value to be the quantile. This is the only sane way to do things, although it requires being slightly more verbose so it can be inconvenient at times. Thus the upper quantile, in which case you do the same integration but start from positive infinity.</p>
<p>The difference is easiest to understand with a picture:</p>
<p>Note that <code>distributions</code> <strong>always</strong> returns a lower quantile from the <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code> function.</p>
<p>If you are truly unfortunate, your instructor may use <span class="math inline">\(z_{\alpha / 2}\)</span> to mean lower tail quantiles at times and upper tail quantiles at other times. If this is the case, only god can help you.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alex Hayes, Ralph Moller-Trane, Daniel Jordan, Paul Northrop, Moritz N. Lang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
