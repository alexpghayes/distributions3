<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>T confidence interval for a mean • distributions3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="T confidence interval for a mean">
<meta property="og:description" content="distributions3">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">distributions3</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a>
    </li>
    <li>
      <a href="../articles/one-sample-sign-tests.html">One sample sign tests</a>
    </li>
    <li>
      <a href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a>
    </li>
    <li>
      <a href="../articles/one-sample-t-test.html">One sample T-tests</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-test.html">One sample Z-tests</a>
    </li>
    <li>
      <a href="../articles/paired-tests.html">Paired tests</a>
    </li>
    <li>
      <a href="../articles/two-sample-z-test.html">Two sample Z-tests</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/alexpghayes/distributions3/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="one-sample-t-confidence-interval_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>T confidence interval for a mean</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions3/blob/HEAD/vignettes/one-sample-t-confidence-interval.Rmd" class="external-link"><code>vignettes/one-sample-t-confidence-interval.Rmd</code></a></small>
      <div class="hidden name"><code>one-sample-t-confidence-interval.Rmd</code></div>

    </div>

    
    
<p>In this vignette we’ll calculate an 88 percent confidence interval for the mean of a single sample. We’ll use the same data we use for a one-sample T-test, which was:</p>
<p><span class="math display">\[
  3, 7, 11, 0, 7, 0, 4, 5, 6, 2
\]</span></p>
<p>Recall that a confidence interval for the mean based off the T distribution is valid when:</p>
<ol style="list-style-type: decimal">
<li>The data comes from a normal distribution.</li>
<li>We have lots of data. How much? Many textbooks use 30 data points as a rule of thumb.</li>
</ol>
<p>In the T-test example we verified that the sample seems to come from a normal distribution using a quantile-quantile plot (QQ-plot).</p>
<p>The formula for a confidence interval with confidence coefficient <span class="math inline">\(1 - \alpha\)</span> (in our case this is 0.88) is then:</p>
<p><span class="math display">\[
  \left( \bar x + t_{n-1, \alpha / 2} \cdot \frac{s}{\sqrt{n}},
  \bar x + t_{n-1, 1 - \alpha / 2} \cdot \frac{s}{\sqrt{n}} \right)
\]</span></p>
<p>where <span class="math inline">\(\bar x = \frac 1n \sum_{i=1}^n x_i\)</span> is the sample mean, <span class="math inline">\(t_{n-1, \alpha / 2}\)</span> is the <span class="math inline">\(\alpha / 2\)</span> lower quantile of a <span class="math inline">\(t_{n-1}\)</span> distribution, <span class="math inline">\(s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x)^2}\)</span> is the sample standard deviation, and <span class="math inline">\(n\)</span> is the sample size. Since the T distribution is symmetric around zero, this is exactly equivalent to</p>
<p><span class="math display">\[
  \left( \bar x - t_{n-1, 1 - \alpha / 2} \cdot \frac{s}{\sqrt{n}},
  \bar x + t_{n-1, 1 - \alpha / 2} \cdot \frac{s}{\sqrt{n}} \right)
\]</span></p>
<p>which may look slightly more familiar. Having trouble seeing what the difference is? Look at the subscript of the quantiles <span class="math inline">\(t\)</span>. Let’s go ahead and calculate this out in R. Since our confidence coefficient is 0.88 (corresponding to an 88 percent confidence interval) we have:</p>
<p><span class="math display">\[
  0.88 = 1 - \alpha
\]</span></p>
<p>so that <span class="math inline">\(\alpha = 0.12\)</span>. Now we can get started.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexpghayes/distributions3" class="external-link">distributions3</a></span><span class="op">)</span>

<span class="co"># read in the data</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="co"># make T_9 random variable</span>
<span class="va">T_9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/StudentsT.html">StudentsT</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>

<span class="co"># first approach</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">T_9</span>, <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.631598</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">T_9</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 6.368402</span></code></pre></div>
<p>So our confidence interval using the first set of equations is (2.63, 6.37). Now we use the second set of equations:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># second approach</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">T_9</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.631598</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">T_9</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.12</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; [1] 6.368402</span></code></pre></div>
<p>We get the same thing! Just like we expected.</p>
<p>There’s one last thing we need to address. You may not have seen either of the formulas for a T-confidence interval that I wrote. You may have seen the formula:</p>
<p><span class="math display">\[
  \left( \bar x - t_{n-1, \alpha / 2} \cdot \frac{s}{\sqrt{n}},
  \bar x + t_{n-1, \alpha / 2} \cdot \frac{s}{\sqrt{n}} \right)
\]</span></p>
<p>If this is you, you have my condolences, and your instructor probably hates you. Ask that they use lower quantile notation rather than upper quantile notation.</p>
<p>This looks almost like the second approach, except using <span class="math inline">\(t_{n-1, \alpha / 2}\)</span> instead of <span class="math inline">\(t_{n-1, 1 - \alpha / 2}\)</span>. What this comes down to is whether or not <span class="math inline">\(t_{n-1, \alpha / 2}\)</span> represents a <em>lower quantile</em> or an <em>upper quantile</em>. For a lower quantile, you look at the p.d.f. and start integrating from negative infinity, stop when the integral equals <span class="math inline">\(\alpha\)</span>, and that take value to be the quantile. This is the only sane way to do things, although it requires being slightly more verbose so it can be inconvenient at times. Thus the upper quantile, in which case you do the same integration but start from positive infinity.</p>
<p>The difference is easiest to understand with a picture:</p>
<p>Note that <code>distributions</code> <strong>always</strong> returns a lower quantile from the <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code> function.</p>
<p>If you are truly unfortunate, your instructor may use <span class="math inline">\(t_{n-1, \alpha / 2}\)</span> to mean lower tail quantiles at times and upper tail quantiles at other times. If this is the case, only god can help you.</p>
<div class="section level2">
<h2 id="using-the-t-test-function">Using the t.test() function<a class="anchor" aria-label="anchor" href="#using-the-t-test-function"></a>
</h2>
<p>If you want to verify that your calculation is correct, R has a function <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> that performs T-tests and calculates T confidence intervals for means.</p>
<p>To get a confidence interval for a single sample, we pass <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> a vector of data, and tell it the confidence coefficient (recall ours was 0.88) via the <code>conf.level</code> argument. <code>conf.level</code> defaults to 0.95, which means if we don’t specify a confidence interval we get a 95 percent confidence interval.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>, conf.level <span class="op">=</span> <span class="fl">0.88</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  x</span>
<span class="co">#&gt; t = 4.1367, df = 9, p-value = 0.002534</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span>
<span class="co">#&gt; 88 percent confidence interval:</span>
<span class="co">#&gt;  2.631598 6.368402</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;       4.5</span></code></pre></div>
<p><code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> returns the interval (2.63, 6.37), exactly what we calculated by hand, which is reassuring. It also does a one-sample T-test for us as well.</p>
<p>If we don’t specify <code>conf.level</code>, we get a 95 percent confidence interval:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  x</span>
<span class="co">#&gt; t = 4.1367, df = 9, p-value = 0.002534</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  2.0392 6.9608</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;       4.5</span></code></pre></div>
<p>This is wider than the 88 percent confidence interval, as we would expect.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alex Hayes, Ralph Moller-Trane, Daniel Jordan, Paul Northrop.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
