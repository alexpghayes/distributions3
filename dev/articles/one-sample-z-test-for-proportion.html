<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One sample Z-tests for a proportion • distributions3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One sample Z-tests for a proportion">
<meta property="og:description" content="distributions3">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">distributions3</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a>
    </li>
    <li>
      <a href="../articles/one-sample-sign-tests.html">One sample sign tests</a>
    </li>
    <li>
      <a href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a>
    </li>
    <li>
      <a href="../articles/one-sample-t-test.html">One sample T-tests</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-test.html">One sample Z-tests</a>
    </li>
    <li>
      <a href="../articles/paired-tests.html">Paired tests</a>
    </li>
    <li>
      <a href="../articles/two-sample-z-test.html">Two sample Z-tests</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/alexpghayes/distributions3/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="one-sample-z-test-for-proportion_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>One sample Z-tests for a proportion</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions3/blob/HEAD/vignettes/one-sample-z-test-for-proportion.Rmd" class="external-link"><code>vignettes/one-sample-z-test-for-proportion.Rmd</code></a></small>
      <div class="hidden name"><code>one-sample-z-test-for-proportion.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we work through an example Z-test a proportion, and point out a number of points where you might get stuck along the way.</p>
<div class="section level2">
<h2 id="problem-setup">Problem setup<a class="anchor" aria-label="anchor" href="#problem-setup"></a>
</h2>
<p>Let’s suppose that a student is interesting in estimating what percent of professors in their department watches Game of Thrones. They go to office hours and ask each professor and it turns out 17 out of 62 professors in their department watch Game of Thrones. Several of the faculty think Game of Thrones is a board game.</p>
<p>We can imagine that the data is a bunch of zeros and ones, where the <span class="math inline">\(i^{th}\)</span> data point, <span class="math inline">\(x_i\)</span> is one if professor <span class="math inline">\(i\)</span> watches Game of Thrones, and zero otherwise. So the full dataset might look something like:</p>
<p><span class="math display">\[
\begin{align}
  &amp; 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1,     \\
  &amp; 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0,  \\
  &amp; 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0
\end{align}
\]</span></p>
<p>But it is much easier to just remember that there are 17 ones and 45 zeros.</p>
</div>
<div class="section level2">
<h2 id="assumption-checking">Assumption checking<a class="anchor" aria-label="anchor" href="#assumption-checking"></a>
</h2>
<p>Before we can do a Z-test, we need to make check if we can reasonably treat the mean of this sample as normally distributed. The data is definitely not from a normal distribution since it’s only zeros and ones, so we need to check if the central limit theorem kicks in.</p>
<p>Most of the time we would check if there were 30 data points or more, but for a proportion, we do something slightly different. When data is binary, like we have here, the central limit theorem kicks in slower than usual. The standard thing to check is whether</p>
<ul>
<li><span class="math inline">\(n \cdot \pi &gt; 5\)</span></li>
<li><span class="math inline">\(n \cdot (1 - \pi) &gt; 5\)</span></li>
</ul>
<p>Where <span class="math inline">\(n\)</span> is the sample size (62 in our case) and <span class="math inline">\(\pi\)</span> is the sample average. Note that some textbooks might use <span class="math inline">\(p\)</span> rather than <span class="math inline">\(\pi\)</span>. In our case we have <span class="math inline">\(\pi = 17 / 62\)</span>, and</p>
<ul>
<li><span class="math inline">\(62 \cdot 17 / 62 = 17\)</span></li>
<li><span class="math inline">\(62 \cdot (1 - 17 / 62) = 45\)</span></li>
</ul>
<p>So we’re good to go.</p>
</div>
<div class="section level2">
<h2 id="null-hypothesis-and-test-statistic">Null hypothesis and test statistic<a class="anchor" aria-label="anchor" href="#null-hypothesis-and-test-statistic"></a>
</h2>
<p>Let’s test the null hypothesis that, on average, twenty percent of professors what Game of Thrones. The corresponding null hypothesis is</p>
<p><span class="math display">\[
  H_0: \pi = 0.2 \qquad H_A: \pi \neq 0.2
\]</span></p>
<p>First we need to calculate our Z-statistic. Remember that the Z-statistic for proportion is</p>
<p><span class="math display">\[
  Z = \frac{\pi - \pi_0}{\sqrt{\frac{\pi_0 (1 - \pi_0)}{n}}} \sim
    \mathrm{Normal}(0, 1)
\]</span></p>
</div>
<div class="section level2">
<h2 id="calculating-p-values">Calculating p-values<a class="anchor" aria-label="anchor" href="#calculating-p-values"></a>
</h2>
<p>In R this looks like:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">62</span>
<span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">17</span> <span class="op">/</span> <span class="fl">62</span>
<span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>

<span class="co"># calculate the z-statistic</span>
<span class="va">z_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pi</span> <span class="op">-</span> <span class="va">pi_0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi_0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_0</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span>
<span class="va">z_stat</span>
<span class="co">#&gt; [1] 1.460501</span></code></pre></div>
<p>To calculate a two-sided p-value, we need to find</p>
<p><span class="math display">\[
\begin{align}
  P(|Z| \ge |1.46|)
  &amp;= P(Z \ge 1.46) + P(Z \le -1.46) \\
  &amp;= 1 - P(Z \le 1.46) + P(Z \le -1.46) \\
  &amp;= 1 - \Phi(1.46) + \Phi(-1.46)
\end{align}
\]</span></p>
<p>To do this we need to c.d.f. of a standard normal</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexpghayes/distributions3" class="external-link">distributions3</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'distributions3'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Gamma</span>
<span class="co">#&gt; The following object is masked from 'package:grDevices':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     pdf</span>

<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normal.html">Normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># make a standard normal r.v.</span>
<span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1.46</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="op">-</span><span class="fl">1.46</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1442901</span></code></pre></div>
<p>Note that we saved <code>z_stat</code> above so we could have also done</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1441523</span></code></pre></div>
<p>which is slightly more accurate since there is no rounding error.</p>
<p>So our p-value is about 0.14. You should verify this with a Z-table. Note that you should get the <em>same</em> value from <code>cdf(Z, 1.46)</code> and looking up <code>1.46</code> on a Z-table.</p>
<p>You may also have seen a different formula for the p-value of a two-sided Z-test, which makes use of the fact that the normal distribution is symmetric:</p>
<p><span class="math display">\[
\begin{align}
  P(|Z| \ge |1.46|)
  &amp;= 2 \cdot P(Z \le -|1.46|)
  &amp;= 2 \cdot \Phi(-1.46)
\end{align}
\]</span></p>
<p>Using this formula we get the same result:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="op">-</span><span class="fl">1.46</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1442901</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="one-sided-z-tests">One-sided Z-tests<a class="anchor" aria-label="anchor" href="#one-sided-z-tests"></a>
</h2>
<p>Finally, sometimes we are interest in one sided Z-tests. For the test</p>
<p><span class="math display">\[
\begin{align}
  H_0: \pi \le 0.2 \qquad H_A: \pi &gt; 0.2
\end{align}
\]</span></p>
<p>the p-value is given by</p>
<p><span class="math display">\[
  P(Z &gt; 1.46)
\]</span></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1.46</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.07214504</span></code></pre></div>
<p>For the test</p>
<p><span class="math display">\[
  H_0: \pi \ge 0.2 \qquad H_A: \pi &lt; 0.2
\]</span></p>
<p>the p-value is given by</p>
<p><span class="math display">\[
  P(Z &lt; 1.46)
\]</span></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1.46</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.927855</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alex Hayes, Ralph Moller-Trane, Daniel Jordan, Paul Northrop.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
