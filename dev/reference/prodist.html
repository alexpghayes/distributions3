<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generic function with methods for various model classes for extracting
fitted (in-sample) or predicted (out-of-sample) probability distributions3
objects."><title>Extracting fitted or predicted probability distributions from models — prodist • distributions3</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extracting fitted or predicted probability distributions from models — prodist"><meta property="og:description" content="Generic function with methods for various model classes for extracting
fitted (in-sample) or predicted (out-of-sample) probability distributions3
objects."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@alexpghayes"><meta name="twitter:site" content="@alexpghayes"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">distributions3</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a>
    <a class="dropdown-item" href="../articles/one-sample-sign-tests.html">One sample sign tests</a>
    <a class="dropdown-item" href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a>
    <a class="dropdown-item" href="../articles/one-sample-t-test.html">One sample T-tests</a>
    <a class="dropdown-item" href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a>
    <a class="dropdown-item" href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a>
    <a class="dropdown-item" href="../articles/one-sample-z-test.html">One sample Z-tests</a>
    <a class="dropdown-item" href="../articles/paired-tests.html">Paired tests</a>
    <a class="dropdown-item" href="../articles/poisson.html">The Poisson distribution: From basic probability theory to regression models</a>
    <a class="dropdown-item" href="../articles/two-sample-z-test.html">Two sample Z-tests</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexpghayes/distributions3/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extracting fitted or predicted probability distributions from models</h1>
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions3/blob/HEAD/R/prodist.R" class="external-link"><code>R/prodist.R</code></a></small>
      <div class="d-none name"><code>prodist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generic function with methods for various model classes for extracting
fitted (in-sample) or predicted (out-of-sample) probability <code>distributions3</code>
objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prodist</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lm</span></span>
<span><span class="fu">prodist</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, sigma <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for glm</span></span>
<span><span class="fu">prodist</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, dispersion <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for distribution</span></span>
<span><span class="fu">prodist</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A model object.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to methods, typically for calling the
underlying <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code> methods, e.g., <code>newdata</code> for
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> or <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> objects or <code>n.ahead</code>
for <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code> objects.</p></dd>


<dt>sigma</dt>
<dd><p>character or numeric or <code>NULL</code>. Specification of the standard
deviation <code>sigma</code> to be used for the <code><a href="Normal.html">Normal</a></code> distribution in the
<code>lm</code> method. The default <code>"ML"</code> (or equivalently <code>"MLE"</code> or <code>NULL</code>)
uses the maximum likelihood estimate based on the residual sum of squares divided
by the number of observations, n. Alternatively, <code>sigma = "OLS"</code> uses the
least-squares estimate (divided by the residual degrees of freedom, n - k). Finally,
a concrete numeric value can also be specified in <code>sigma</code>.</p></dd>


<dt>dispersion</dt>
<dd><p>character or numeric or <code>NULL</code>. Specification of the
dispersion parameter in the <code>glm</code> method. The default <code>NULL</code>
(or equivalently <code>"deviance"</code>) is to use the <code><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></code>
divided by the number of observations, n. Alternatively, <code>dispersion = "Chisquared"</code>
uses the Chi-squared statistic divided by the residual degrees of freedom, n - k.
Finally, a concrete numeric value can also be specified in <code>dispersion</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object inheriting from <code>distribution</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To facilitate making probabilistic forecasts based on regression and time
series model objects, the function <code>prodist</code> extracts fitted or
predicted probability <code>distribution</code> objects. Currently, methods are
provided for objects fitted by <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>,
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, and <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code> in base R as
well as <code>glm.nb</code> from the <span class="pkg">MASS</span> package and
<code>hurdle</code>/<code>zeroinfl</code>/<code>zerotrunc</code> from the <span class="pkg">pscl</span> or
<span class="pkg">countreg</span> packages.</p>
<p>All methods essentially
proceed in two steps: First, the standard <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code>
method for these model objects is used to compute fitted (in-sample, default)
or predicted (out-of-sample) distribution parameters. Typically, this includes
the mean plus further parameters describing scale, dispersion, shape, etc.).
Second, the <code>distributions</code> objects are set up using the generator
functions from <span class="pkg">distributions3</span>.</p>
<p>Note that these probability distributions only reflect the random variation in
the dependent variable based on the model employed (and its associated
distributional assumpation for the dependent variable). This does not capture
the uncertainty in the parameter estimates.</p>
<p>For both linear regression models and generalized linear models, estimated
by <code>lm</code> and <code>glm</code> respectively, there is some ambiguity as to which
estimate for the dispersion parameter of the model is to be used. While the
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></code> methods use the maximum-likelihood (ML) estimate
implicitly, the <code>summary</code> methods report an estimate that is standardized
with the residual degrees of freedom, n - k (rather than the number of
observations, n). The <code>prodist</code> methods for these objects follow
the <code>logLik</code> method by default but the <code>summary</code> behavior can be
mimicked by setting the <code>sigma</code> or <code>dispersion</code> arguments
accordingly.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code>, <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>,
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Model: Linear regression</span></span></span>
<span class="r-in"><span><span class="co">## Fit: lm</span></span></span>
<span class="r-in"><span><span class="co">## Data: 1920s cars data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cars"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Stopping distance (ft) explained by speed (mph)</span></span></span>
<span class="r-in"><span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract fitted normal distributions (in-sample, with constant variance)</span></span></span>
<span class="r-in"><span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">prodist</span><span class="op">(</span><span class="va">reg</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    1                                    2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = -1.849, sigma = 15.07)" "Normal(mu = -1.849, sigma = 15.07)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    3                                    4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu =  9.948, sigma = 15.07)" "Normal(mu =  9.948, sigma = 15.07)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    5                                    6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 13.880, sigma = 15.07)" "Normal(mu = 17.813, sigma = 15.07)" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract log-likelihood from model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">reg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -206.5784 (df=3)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Replicate log-likelihood via distributions object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="pdf.html">log_pdf</a></span><span class="op">(</span><span class="va">pd</span>, <span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -206.5784</span>
<span class="r-in"><span><span class="fu"><a href="log_likelihood.html">log_likelihood</a></span><span class="op">(</span><span class="va">pd</span>, <span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -206.5784</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute corresponding medians and 90% interval</span></span></span>
<span class="r-in"><span><span class="va">qd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">pd</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">qd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q_0.05     q_0.5   q_0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -26.635522 -1.849460 22.93660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -26.635522 -1.849460 22.93660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -14.838296  9.947766 34.73383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -14.838296  9.947766 34.73383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -10.905887 13.880175 38.66624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -6.973478 17.812584 42.59865</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualize observations with predicted quantiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span>, <span class="va">qd</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prodist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Sigma estimated by maximum-likelihood estimate (default, used in logLik)</span></span></span>
<span class="r-in"><span><span class="co">## vs. least-squares estimate (used in summary)</span></span></span>
<span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>speed <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">prodist</span><span class="op">(</span><span class="va">reg</span>, newdata <span class="op">=</span> <span class="va">nd</span>, sigma <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 179, sigma = 15.07)" </span>
<span class="r-in"><span><span class="fu">prodist</span><span class="op">(</span><span class="va">reg</span>, newdata <span class="op">=</span> <span class="va">nd</span>, sigma <span class="op">=</span> <span class="st">"OLS"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 179, sigma = 15.38)" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15.37959</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model: Poisson generalized linear model</span></span></span>
<span class="r-in"><span><span class="co">## Fit: glm</span></span></span>
<span class="r-in"><span><span class="co">## Data: FIFA 2018 World Cup data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"FIFA2018"</span>, package <span class="op">=</span> <span class="st">"distributions3"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Number of goals per team explained by ability differences</span></span></span>
<span class="r-in"><span><span class="va">poisreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">goals</span> <span class="op">~</span> <span class="va">difference</span>, data <span class="op">=</span> <span class="va">FIFA2018</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">poisreg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = goals ~ difference, family = poisson, data = FIFA2018)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.21272    0.08125   2.618  0.00885 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference   0.41344    0.10579   3.908 9.31e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 144.20  on 127  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 128.69  on 126  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 359.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Interpretation: When the ratio of abilities increases by 1 percent,</span></span></span>
<span class="r-in"><span><span class="co">## the expected number of goals increases by around 0.4 percent</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Predict fitted Poisson distributions for teams with equal ability (out-of-sample)</span></span></span>
<span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">prodist</span><span class="op">(</span><span class="va">poisreg</span>, newdata <span class="op">=</span> <span class="va">nd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Poisson(lambda = 1.237)" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract fitted Poisson distributions (in-sample)</span></span></span>
<span class="r-in"><span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">prodist</span><span class="op">(</span><span class="va">poisreg</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          1                          2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Poisson(lambda = 1.7680)" "Poisson(lambda = 0.8655)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          3                          4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Poisson(lambda = 1.0297)" "Poisson(lambda = 1.4862)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          5                          6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Poisson(lambda = 1.4354)" "Poisson(lambda = 1.0661)" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract log-likelihood from model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">poisreg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -177.6971 (df=2)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Replicate log-likelihood via distributions object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="pdf.html">log_pdf</a></span><span class="op">(</span><span class="va">pd</span>, <span class="va">FIFA2018</span><span class="op">$</span><span class="va">goals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -177.6971</span>
<span class="r-in"><span><span class="fu"><a href="log_likelihood.html">log_likelihood</a></span><span class="op">(</span><span class="va">pd</span>, <span class="va">FIFA2018</span><span class="op">$</span><span class="va">goals</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -177.6971</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model: Autoregressive integrated moving average model</span></span></span>
<span class="r-in"><span><span class="co">## Fit: arima</span></span></span>
<span class="r-in"><span><span class="co">## Data: Quarterly approval ratings of U.S. presidents (1945-1974)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"presidents"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ARMA(2,1) model</span></span></span>
<span class="r-in"><span><span class="va">arma21</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></span><span class="op">(</span><span class="va">presidents</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract predicted normal distributions for next two years</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">prodist</span><span class="op">(</span><span class="va">arma21</span>, n.ahead <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            1975 Qtr1                            1975 Qtr2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 29.58, sigma =  9.013)" "Normal(mu = 32.41, sigma = 11.118)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            1975 Qtr3                            1975 Qtr4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 36.45, sigma = 12.935)" "Normal(mu = 38.61, sigma = 13.821)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            1976 Qtr1                            1976 Qtr2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 41.54, sigma = 14.648)" "Normal(mu = 43.19, sigma = 15.092)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            1976 Qtr3                            1976 Qtr4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Normal(mu = 45.32, sigma = 15.507)" "Normal(mu = 46.58, sigma = 15.743)" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute median (= mean) forecast along with 80% and 95% interval</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">p</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              q_0.5    q_0.1    q_0.9  q_0.025  q_0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1975 Qtr1 29.58398 18.03366 41.13430 11.91929 47.24867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1975 Qtr2 32.40878 18.15989 46.65767 10.61698 54.20058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1975 Qtr3 36.44588 19.86888 53.02287 11.09355 61.79820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1975 Qtr4 38.61415 20.90236 56.32594 11.52630 65.70199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1976 Qtr1 41.53897 22.76708 60.31085 12.82984 70.24809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1976 Qtr2 43.19489 23.85376 62.53602 13.61519 72.77459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1976 Qtr3 45.31799 25.44445 65.19152 14.92404 75.71194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1976 Qtr4 46.57728 26.40232 66.75224 15.72234 77.43222</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Hayes, Ralph Moller-Trane, Daniel Jordan, Paul Northrop, Moritz N. Lang, Achim Zeileis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

